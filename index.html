<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Kelimeli Mahjong - Ger√ßek Mahjong Mekaniƒüi</title>
  <style>
    * { box-sizing: border-box; }
    body { 
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; 
      background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); 
      color: #e5e7eb; 
      margin: 0; 
      padding: 20px; 
      min-height: 100vh;
    }
    
    .container { max-width: 1400px; margin: 0 auto; }
    
    h1 { 
      text-align: center; 
      margin: 0 0 20px; 
      font-size: 2.5em;
      background: linear-gradient(135deg, #3b82f6, #8b5cf6);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .layout { 
      display: grid; 
      grid-template-columns: 280px 1fr 280px; 
      gap: 20px; 
      align-items: start;
    }
    
    @media (max-width: 1200px) { 
      .layout { grid-template-columns: 1fr; } 
      .sidebar { max-width: 500px; margin: 0 auto; }
    }
    
    .panel { 
      background: rgba(15, 23, 42, 0.8); 
      border: 1px solid #334155; 
      border-radius: 16px; 
      padding: 20px; 
      backdrop-filter: blur(10px);
    }
    
    .panel h3 { 
      margin: 0 0 16px; 
      font-size: 1.3em;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    /* Kontroller */
    .controls { display: flex; flex-direction: column; gap: 12px; }
    .control-group { display: flex; flex-direction: column; gap: 6px; }
    .control-group label { 
      font-size: 0.85em; 
      color: #94a3b8; 
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    select, button, input { 
      background: #1e293b; 
      color: #e5e7eb; 
      border: 1px solid #475569; 
      border-radius: 10px; 
      padding: 12px 16px; 
      font-size: 1em;
      width: 100%;
      transition: all 0.2s;
    }
    
    select:hover, input:hover { border-color: #64748b; }
    
    button { 
      cursor: pointer; 
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    button:hover:not(:disabled) { 
      transform: translateY(-2px); 
      box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
    }
    
    button.primary { 
      background: linear-gradient(135deg, #3b82f6, #2563eb); 
      border: none;
      color: white;
    }
    
    button.secondary { 
      background: linear-gradient(135deg, #8b5cf6, #7c3aed); 
      border: none;
      color: white;
    }
    
    button.warn { 
      background: linear-gradient(135deg, #dc2626, #b91c1c); 
      border: none;
      color: white;
    }
    
    button:disabled { 
      opacity: 0.5; 
      cursor: not-allowed; 
      transform: none !important;
    }
    
    /* ƒ∞statistikler */
    .stats { 
      display: grid; 
      grid-template-columns: 1fr 1fr; 
      gap: 12px; 
      margin-top: 16px;
    }
    
    .stat-box { 
      background: #0f172a; 
      border: 1px solid #334155; 
      border-radius: 12px; 
      padding: 12px; 
      text-align: center;
    }
    
    .stat-label { 
      font-size: 0.75em; 
      color: #94a3b8; 
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 4px;
    }
    
    .stat-value { 
      font-size: 1.8em; 
      font-weight: 700;
      background: linear-gradient(135deg, #3b82f6, #8b5cf6);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    /* Skorlar */
    .score-list { 
      max-height: 400px; 
      overflow-y: auto; 
    }
    
    .score-item { 
      background: #0f172a; 
      border: 1px solid #334155; 
      border-radius: 10px; 
      padding: 12px; 
      margin-bottom: 8px;
      transition: all 0.2s;
    }
    
    .score-item:hover { 
      border-color: #3b82f6; 
      transform: translateX(4px);
    }
    
    .score-item.top { 
      border: 2px solid #22c55e;
      background: linear-gradient(135deg, rgba(34, 197, 94, 0.1), rgba(34, 197, 94, 0.05));
    }
    
    .score-header { 
      display: flex; 
      justify-content: space-between; 
      align-items: center;
      margin-bottom: 6px;
    }
    
    .score-name { 
      font-weight: 700; 
      font-size: 1.1em;
      color: #3b82f6;
    }
    
    .score-points { 
      font-size: 1.3em; 
      font-weight: 700;
      color: #22c55e;
    }
    
    .score-details { 
      font-size: 0.85em; 
      color: #94a3b8; 
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }
    
    /* Oyun Tahtasƒ± */
    .board-container { 
      position: relative; 
      min-height: 500px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .board { 
      position: relative;
      display: inline-block;
    }
    
    .tile { 
      position: absolute;
      width: 80px;
      height: 100px;
      background: linear-gradient(145deg, #f8fafc, #e2e8f0);
      border: 2px solid #cbd5e1;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      font-weight: 700;
      font-size: 14px;
      color: #0f172a;
      cursor: pointer;
      user-select: none;
      transition: all 0.15s ease;
      box-shadow: 
        0 2px 4px rgba(0,0,0,0.1),
        inset 0 1px 0 rgba(255,255,255,0.5);
      padding: 8px;
      word-wrap: break-word;
      line-height: 1.2;
    }
    
    .tile:hover:not(.matched):not(.blocked) { 
      transform: translateY(-4px) scale(1.05); 
      border-color: #3b82f6;
      box-shadow: 
        0 8px 16px rgba(59, 130, 246, 0.3),
        inset 0 1px 0 rgba(255,255,255,0.5);
      z-index: 10000 !important;
    }
    
    .tile.selected { 
      background: linear-gradient(145deg, #dbeafe, #bfdbfe);
      border-color: #3b82f6;
      border-width: 3px;
      transform: translateY(-6px) scale(1.08);
      box-shadow: 
        0 12px 24px rgba(59, 130, 246, 0.4),
        inset 0 1px 0 rgba(255,255,255,0.7);
    }
    
    .tile.matched { 
      background: linear-gradient(145deg, #d1fae5, #a7f3d0);
      border-color: #22c55e;
      color: #065f46;
      animation: matchPulse 0.5s ease;
      pointer-events: none;
    }
    
    .tile.blocked { 
      opacity: 0.4;
      cursor: not-allowed;
      filter: grayscale(0.6);
    }
    
    @keyframes matchPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.15); }
    }
    
    /* Durum mesajlarƒ± */
    .status { 
      text-align: center; 
      margin-top: 20px; 
      font-size: 1.2em;
      font-weight: 600;
      min-height: 30px;
    }
    
    .success { color: #22c55e; }
    .danger { color: #ef4444; }
    .info { color: #3b82f6; }
    
    /* Yardƒ±m */
    .help { 
      background: rgba(59, 130, 246, 0.1); 
      border: 1px solid #3b82f6; 
      border-radius: 10px; 
      padding: 12px; 
      font-size: 0.9em;
      line-height: 1.6;
      margin-top: 16px;
    }
    
    .help-title { 
      font-weight: 700; 
      color: #3b82f6; 
      margin-bottom: 8px;
    }
    
    .badge {
      display: inline-block;
      background: #1e293b;
      border: 1px solid #334155;
      border-radius: 6px;
      padding: 4px 8px;
      font-size: 0.75em;
      font-weight: 600;
      margin: 2px;
    }
    
    .name-display {
      background: #0f172a;
      border: 1px solid #334155;
      border-radius: 8px;
      padding: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }
    
    .player-name {
      font-weight: 700;
      color: #3b82f6;
      font-size: 1.1em;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üÄÑ Kelimeli Mahjong</h1>
    
    <div class="layout">
      <!-- Sol Panel: Kontroller -->
      <aside class="sidebar panel">
        <h3>‚öôÔ∏è Ayarlar</h3>
        
        <div class="name-display">
          <span class="player-name" id="playerNameLabel">Oyuncu</span>
          <button id="changeNameBtn" style="width: auto; padding: 6px 12px; font-size: 0.85em;">Deƒüi≈ütir</button>
        </div>
        
        <div class="controls">
          <div class="control-group">
            <label>Dil</label>
            <select id="langSelect">
              <option value="en">üá¨üáß ƒ∞ngilizce</option>
              <option value="kr">üá∞üá∑ Korece</option>
            </select>
          </div>
          
          <div class="control-group">
            <label>Seviye</label>
            <select id="levelSelect">
              <option value="easy">Kolay (18 √ßift)</option>
              <option value="medium">Orta (36 √ßift)</option>
              <option value="hard">Zor (72 √ßift)</option>
            </select>
          </div>
          
          <div class="control-group">
            <label>S√ºre</label>
            <select id="timeSelect">
              <option value="180">3 Dakika</option>
              <option value="300">5 Dakika</option>
              <option value="600">10 Dakika</option>
              <option value="0">Sƒ±nƒ±rsƒ±z</option>
            </select>
          </div>
          
          <button class="primary" id="startBtn">üéÆ Oyunu Ba≈ülat</button>
          <button class="secondary" id="hintBtn" disabled>üí° ƒ∞pucu</button>
          <button class="warn" id="resetBtn" disabled>üîÑ Yeniden Ba≈ülat</button>
        </div>
        
        <div class="stats">
          <div class="stat-box">
            <div class="stat-label">S√ºre</div>
            <div class="stat-value" id="timeLeft">0:00</div>
          </div>
          <div class="stat-box">
            <div class="stat-label">Puan</div>
            <div class="stat-value" id="score">0</div>
          </div>
          <div class="stat-box">
            <div class="stat-label">E≈üle≈üme</div>
            <div class="stat-value" id="matches">0/0</div>
          </div>
          <div class="stat-box">
            <div class="stat-label">Hamle</div>
            <div class="stat-value" id="moves">0</div>
          </div>
        </div>
        
        <div class="help">
          <div class="help-title">üìñ Nasƒ±l Oynanƒ±r?</div>
          Sadece <strong>a√ßƒ±k</strong> (√ºzerinde ta≈ü olmayan) ve <strong>yan kenarlarƒ± bo≈ü</strong> ta≈ülar se√ßilebilir. Aynƒ± kelimeleri e≈üle≈ütirin!
          <div style="margin-top:8px">
            <span class="badge">‚úì Doƒüru: +100</span>
            <span class="badge">‚úó Yanlƒ±≈ü: -25</span>
          </div>
        </div>
      </aside>
      
      <!-- Orta Panel: Oyun Tahtasƒ± -->
      <main class="panel">
        <div class="board-container">
          <div id="board" class="board"></div>
        </div>
        <div class="status" id="status"></div>
      </main>
      
      <!-- Saƒü Panel: En ƒ∞yi Skorlar -->
      <aside class="sidebar panel">
        <h3>üèÜ En ƒ∞yi Skorlar</h3>
        <div class="score-list" id="scoreList">
          <div style="text-align: center; color: #64748b; padding: 20px;">
            Hen√ºz skor yok
          </div>
        </div>
        <button class="warn" id="clearScoresBtn" style="margin-top: 12px;">üóëÔ∏è Skorlarƒ± Temizle</button>
      </aside>
    </div>
  </div>

  <script>
    // ===== KELƒ∞ME HAVUZU (100+ kelime) =====
    const wordPool = {
      en: [
        'apple', 'book', 'water', 'sun', 'dog', 'house', 'travel', 'friend', 'music', 'money',
        'city', 'food', 'work', 'school', 'time', 'day', 'night', 'family', 'love', 'game',
        'learn', 'write', 'read', 'think', 'speak', 'listen', 'walk', 'run', 'jump', 'sleep',
        'dream', 'hope', 'peace', 'truth', 'light', 'dark', 'fire', 'earth', 'wind', 'rain',
        'snow', 'cloud', 'star', 'moon', 'tree', 'flower', 'bird', 'fish', 'cat', 'horse',
        'river', 'ocean', 'mountain', 'forest', 'desert', 'island', 'bridge', 'road', 'car', 'train',
        'plane', 'ship', 'bike', 'phone', 'computer', 'camera', 'watch', 'key', 'door', 'window',
        'chair', 'table', 'bed', 'lamp', 'mirror', 'picture', 'pen', 'paper', 'letter', 'story',
        'song', 'dance', 'paint', 'draw', 'play', 'teach', 'help', 'smile', 'laugh', 'cry',
        'happy', 'sad', 'angry', 'calm', 'brave', 'strong', 'smart', 'kind', 'good', 'bad',
        'big', 'small', 'fast', 'slow', 'hot', 'cold', 'new', 'old', 'young', 'free'
      ],
      kr: [
        'ÏÇ¨Í≥º', 'Ï±Ö', 'Î¨º', 'Ìï¥', 'Í∞ú', 'Ïßë', 'Ïó¨Ìñâ', 'ÏπúÍµ¨', 'ÏùåÏïÖ', 'Îèà',
        'ÎèÑÏãú', 'ÏùåÏãù', 'Ïùº', 'ÌïôÍµê', 'ÏãúÍ∞Ñ', 'ÎÇÆ', 'Î∞§', 'Í∞ÄÏ°±', 'ÏÇ¨Îûë', 'Í≤åÏûÑ',
        'Î∞∞Ïö∞Îã§', 'Ïì∞Îã§', 'ÏùΩÎã§', 'ÏÉùÍ∞Å', 'ÎßêÌïòÎã§', 'Îì£Îã§', 'Í±∑Îã§', 'Îã¨Î¶¨Îã§', 'Ï†êÌîÑ', 'ÏûêÎã§',
        'Íøà', 'Ìù¨Îßù', 'ÌèâÌôî', 'ÏßÑÏã§', 'Îπõ', 'Ïñ¥Îë†', 'Î∂à', 'ÎïÖ', 'Î∞îÎûå', 'ÎπÑ',
        'Îàà', 'Íµ¨Î¶Ñ', 'Î≥Ñ', 'Îã¨', 'ÎÇòÎ¨¥', 'ÍΩÉ', 'ÏÉà', 'Î¨ºÍ≥†Í∏∞', 'Í≥†ÏñëÏù¥', 'Îßê',
        'Í∞ï', 'Î∞îÎã§', 'ÏÇ∞', 'Ïà≤', 'ÏÇ¨Îßâ', 'ÏÑ¨', 'Îã§Î¶¨', 'Í∏∏', 'Ï∞®', 'Í∏∞Ï∞®',
        'ÎπÑÌñâÍ∏∞', 'Î∞∞', 'ÏûêÏ†ÑÍ±∞', 'Ï†ÑÌôî', 'Ïª¥Ìì®ÌÑ∞', 'Ïπ¥Î©îÎùº', 'ÏãúÍ≥Ñ', 'Ïó¥Ïá†', 'Î¨∏', 'Ï∞ΩÎ¨∏',
        'ÏùòÏûê', 'ÌÖåÏù¥Î∏î', 'Ïπ®ÎåÄ', 'Îû®ÌîÑ', 'Í±∞Ïö∏', 'Í∑∏Î¶º', 'Ìéú', 'Ï¢ÖÏù¥', 'Ìé∏ÏßÄ', 'Ïù¥ÏïºÍ∏∞',
        'ÎÖ∏Îûò', 'Ï∂§', 'Í∑∏Î¶¨Îã§', 'Í∑∏Î¶¨Îã§', 'ÎÜÄÎã§', 'Í∞ÄÎ•¥ÏπòÎã§', 'ÎèïÎã§', 'ÎØ∏ÏÜå', 'ÏõÉÎã§', 'Ïö∏Îã§',
        'ÌñâÎ≥µ', 'Ïä¨Ìîî', 'ÌôîÎÇ®', 'Ï∞®Î∂Ñ', 'Ïö©Í∞ê', 'Í∞ïÌïú', 'ÎòëÎòë', 'ÏπúÏ†à', 'Ï¢ãÏùÄ', 'ÎÇòÏÅú',
        'ÌÅ∞', 'ÏûëÏùÄ', 'Îπ†Î•∏', 'ÎäêÎ¶∞', 'Îú®Í±∞Ïö¥', 'Ï∞®Í∞ÄÏö¥', 'ÏÉàÎ°úÏö¥', 'Ïò§ÎûòÎêú', 'Ï†äÏùÄ', 'ÏûêÏú†'
      ]
    };

    // ===== MAHJONG D√úZENLERƒ∞ =====
    const layouts = {
      easy: [ // 18 √ßift = 36 ta≈ü
        // Katman 0 (taban)
        {x:1,y:0,z:0},{x:2,y:0,z:0},{x:3,y:0,z:0},{x:4,y:0,z:0},{x:5,y:0,z:0},{x:6,y:0,z:0},
        {x:1,y:1,z:0},{x:2,y:1,z:0},{x:3,y:1,z:0},{x:4,y:1,z:0},{x:5,y:1,z:0},{x:6,y:1,z:0},
        {x:1,y:2,z:0},{x:2,y:2,z:0},{x:3,y:2,z:0},{x:4,y:2,z:0},{x:5,y:2,z:0},{x:6,y:2,z:0},
        {x:1,y:3,z:0},{x:2,y:3,z:0},{x:3,y:3,z:0},{x:4,y:3,z:0},{x:5,y:3,z:0},{x:6,y:3,z:0},
        // Katman 1
        {x:2,y:1,z:1},{x:3,y:1,z:1},{x:4,y:1,z:1},{x:5,y:1,z:1},
        {x:2,y:2,z:1},{x:3,y:2,z:1},{x:4,y:2,z:1},{x:5,y:2,z:1},
        // Katman 2
        {x:3,y:1,z:2},{x:4,y:1,z:2},{x:3,y:2,z:2},{x:4,y:2,z:2}
      ],
      medium: [ // 36 √ßift = 72 ta≈ü
        // Katman 0
        {x:0,y:1,z:0},{x:1,y:1,z:0},{x:2,y:1,z:0},{x:3,y:1,z:0},{x:4,y:1,z:0},{x:5,y:1,z:0},{x:6,y:1,z:0},{x:7,y:1,z:0},
        {x:0,y:2,z:0},{x:1,y:2,z:0},{x:2,y:2,z:0},{x:3,y:2,z:0},{x:4,y:2,z:0},{x:5,y:2,z:0},{x:6,y:2,z:0},{x:7,y:2,z:0},
        {x:0,y:3,z:0},{x:1,y:3,z:0},{x:2,y:3,z:0},{x:3,y:3,z:0},{x:4,y:3,z:0},{x:5,y:3,z:0},{x:6,y:3,z:0},{x:7,y:3,z:0},
        {x:0,y:4,z:0},{x:1,y:4,z:0},{x:2,y:4,z:0},{x:3,y:4,z:0},{x:4,y:4,z:0},{x:5,y:4,z:0},{x:6,y:4,z:0},{x:7,y:4,z:0},
        // Katman 1
        {x:1,y:1,z:1},{x:2,y:1,z:1},{x:3,y:1,z:1},{x:4,y:1,z:1},{x:5,y:1,z:1},{x:6,y:1,z:1},
        {x:1,y:2,z:1},{x:2,y:2,z:1},{x:3,y:2,z:1},{x:4,y:2,z:1},{x:5,y:2,z:1},{x:6,y:2,z:1},
        {x:1,y:3,z:1},{x:2,y:3,z:1},{x:3,y:3,z:1},{x:4,y:3,z:1},{x:5,y:3,z:1},{x:6,y:3,z:1},
        {x:1,y:4,z:1},{x:2,y:4,z:1},{x:3,y:4,z:1},{x:4,y:4,z:1},{x:5,y:4,z:1},{x:6,y:4,z:1},
        // Katman 2
        {x:2,y:2,z:2},{x:3,y:2,z:2},{x:4,y:2,z:2},{x:5,y:2,z:2},
        {x:2,y:3,z:2},{x:3,y:3,z:2},{x:4,y:3,z:2},{x:5,y:3,z:2},
        // Katman 3
        {x:3,y:2,z:3},{x:4,y:2,z:3},{x:3,y:3,z:3},{x:4,y:3,z:3}
      ],
      hard: [ // 72 √ßift = 144 ta≈ü (klasik mahjong)
        // Katman 0
        {x:2,y:0,z:0},{x:3,y:0,z:0},{x:4,y:0,z:0},{x:5,y:0,z:0},{x:6,y:0,z:0},{x:7,y:0,z:0},{x:8,y:0,z:0},{x:9,y:0,z:0},{x:10,y:0,z:0},
        {x:1,y:1,z:0},{x:2,y:1,z:0},{x:3,y:1,z:0},{x:4,y:1,z:0},{x:5,y:1,z:0},{x:6,y:1,z:0},{x:7,y:1,z:0},{x:8,y:1,z:0},{x:9,y:1,z:0},{x:10,y:1,z:0},{x:11,y:1,z:0},
        {x:0,y:2,z:0},{x:1,y:2,z:0},{x:2,y:2,z:0},{x:3,y:2,z:0},{x:4,y:2,z:0},{x:5,y:2,z:0},{x:6,y:2,z:0},{x:7,y:2,z:0},{x:8,y:2,z:0},{x:9,y:2,z:0},{x:10,y:2,z:0},{x:11,y:2,z:0},{x:12,y:2,z:0},
        {x:0,y:3,z:0},{x:1,y:3,z:0},{x:2,y:3,z:0},{x:3,y:3,z:0},{x:4,y:3,z:0},{x:5,y:3,z:0},{x:6,y:3,z:0},{x:7,y:3,z:0},{x:8,y:3,z:0},{x:9,y:3,z:0},{x:10,y:3,z:0},{x:11,y:3,z:0},{x:12,y:3,z:0},
        {x:0,y:4,z:0},{x:1,y:4,z:0},{x:2,y:4,z:0},{x:3,y:4,z:0},{x:4,y:4,z:0},{x:5,y:4,z:0},{x:6,y:4,z:0},{x:7,y:4,z:0},{x:8,y:4,z:0},{x:9,y:4,z:0},{x:10,y:4,z:0},{x:11,y:4,z:0},{x:12,y:4,z:0},
        {x:0,y:5,z:0},{x:1,y:5,z:0},{x:2,y:5,z:0},{x:3,y:5,z:0},{x:4,y:5,z:0},{x:5,y:5,z:0},{x:6,y:5,z:0},{x:7,y:5,z:0},{x:8,y:5,z:0},{x:9,y:5,z:0},{x:10,y:5,z:0},{x:11,y:5,z:0},{x:12,y:5,z:0},
        {x:1,y:6,z:0},{x:2,y:6,z:0},{x:3,y:6,z:0},{x:4,y:6,z:0},{x:5,y:6,z:0},{x:6,y:6,z:0},{x:7,y:6,z:0},{x:8,y:6,z:0},{x:9,y:6,z:0},{x:10,y:6,z:0},{x:11,y:6,z:0},
        {x:2,y:7,z:0},{x:3,y:7,z:0},{x:4,y:7,z:0},{x:5,y:7,z:0},{x:6,y:7,z:0},{x:7,y:7,z:0},{x:8,y:7,z:0},{x:9,y:7,z:0},{x:10,y:7,z:0},
        // Katman 1
        {x:2,y:1,z:1},{x:3,y:1,z:1},{x:4,y:1,z:1},{x:5,y:1,z:1},{x:6,y:1,z:1},{x:7,y:1,z:1},{x:8,y:1,z:1},{x:9,y:1,z:1},{x:10,y:1,z:1},
        {x:2,y:2,z:1},{x:3,y:2,z:1},{x:4,y:2,z:1},{x:5,y:2,z:1},{x:6,y:2,z:1},{x:7,y:2,z:1},{x:8,y:2,z:1},{x:9,y:2,z:1},{x:10,y:2,z:1},
        {x:2,y:3,z:1},{x:3,y:3,z:1},{x:4,y:3,z:1},{x:5,y:3,z:1},{x:6,y:3,z:1},{x:7,y:3,z:1},{x:8,y:3,z:1},{x:9,y:3,z:1},{x:10,y:3,z:1},
        {x:2,y:4,z:1},{x:3,y:4,z:1},{x:4,y:4,z:1},{x:5,y:4,z:1},{x:6,y:4,z:1},{x:7,y:4,z:1},{x:8,y:4,z:1},{x:9,y:4,z:1},{x:10,y:4,z:1},
        {x:2,y:5,z:1},{x:3,y:5,z:1},{x:4,y:5,z:1},{x:5,y:5,z:1},{x:6,y:5,z:1},{x:7,y:5,z:1},{x:8,y:5,z:1},{x:9,y:5,z:1},{x:10,y:5,z:1},
        {x:2,y:6,z:1},{x:3,y:6,z:1},{x:4,y:6,z:1},{x:5,y:6,z:1},{x:6,y:6,z:1},{x:7,y:6,z:1},{x:8,y:6,z:1},{x:9,y:6,z:1},{x:10,y:6,z:1},
        // Katman 2
        {x:3,y:2,z:2},{x:4,y:2,z:2},{x:5,y:2,z:2},{x:6,y:2,z:2},{x:7,y:2,z:2},{x:8,y:2,z:2},{x:9,y:2,z:2},
        {x:3,y:3,z:2},{x:4,y:3,z:2},{x:5,y:3,z:2},{x:6,y:3,z:2},{x:7,y:3,z:2},{x:8,y:3,z:2},{x:9,y:3,z:2},
        {x:3,y:4,z:2},{x:4,y:4,z:2},{x:5,y:4,z:2},{x:6,y:4,z:2},{x:7,y:4,z:2},{x:8,y:4,z:2},{x:9,y:4,z:2},
        {x:3,y:5,z:2},{x:4,y:5,z:2},{x:5,y:5,z:2},{x:6,y:5,z:2},{x:7,y:5,z:2},{x:8,y:5,z:2},{x:9,y:5,z:2},
        // Katman 3
        {x:4,y:3,z:3},{x:5,y:3,z:3},{x:6,y:3,z:3},{x:7,y:3,z:3},{x:8,y:3,z:3},
        {x:4,y:4,z:3},{x:5,y:4,z:3},{x:6,y:4,z:3},{x:7,y:4,z:3},{x:8,y:4,z:3},
        // Katman 4
        {x:5,y:3,z:4},{x:6,y:3,z:4},{x:7,y:3,z:4},
        {x:5,y:4,z:4},{x:6,y:4,z:4},{x:7,y:4,z:4},
        // Katman 5 (tepe)
        {x:6,y:3,z:5},{x:6,y:4,z:5}
      ]
    };

    // ===== DOM Elemanlarƒ± =====
    const langSelect = document.getElementById('langSelect');
    const levelSelect = document.getElementById('levelSelect');
    const timeSelect = document.getElementById('timeSelect');
    const startBtn = document.getElementById('startBtn');
    const resetBtn = document.getElementById('resetBtn');
    const hintBtn = document.getElementById('hintBtn');
    const boardEl = document.getElementById('board');
    const scoreEl = document.getElementById('score');
    const matchesEl = document.getElementById('matches');
    const movesEl = document.getElementById('moves');
    const timeLeftEl = document.getElementById('timeLeft');
    const statusEl = document.getElementById('status');
    const scoreListEl = document.getElementById('scoreList');
    const clearScoresBtn = document.getElementById('clearScoresBtn');
    const playerNameLabel = document.getElementById('playerNameLabel');
    const changeNameBtn = document.getElementById('changeNameBtn');

    // ===== Oyun Durumu =====
    let tiles = [];
    let selectedTile = null;
    let score = 0;
    let moves = 0;
    let matches = 0;
    let totalPairs = 0;
    let gameActive = false;
    let timer = null;
    let timeRemaining = 0;
    const SCORES_KEY = 'mahjong_scores_v3';
    const NAME_KEY = 'mahjong_player_name';

    // ===== Yardƒ±mcƒ± Fonksiyonlar =====
    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    function formatTime(seconds) {
      if (seconds === 0) return '‚àû';
      const mins = Math.floor(seconds / 60);
      const secs = seconds % 60;
      return `${mins}:${secs.toString().padStart(2, '0')}`;
    }

    // ===== ƒ∞sim Y√∂netimi =====
    function getPlayerName() {
      let name = localStorage.getItem(NAME_KEY);
      if (!name) {
        name = prompt('Oyuncu adƒ±nƒ±zƒ± girin:', 'Oyuncu') || 'Oyuncu';
        localStorage.setItem(NAME_KEY, name);
      }
      playerNameLabel.textContent = name;
      return name;
    }

    changeNameBtn.addEventListener('click', () => {
      const name = prompt('Yeni oyuncu adƒ±nƒ± girin:', localStorage.getItem(NAME_KEY) || 'Oyuncu');
      if (name) {
        localStorage.setItem(NAME_KEY, name);
        playerNameLabel.textContent = name;
      }
    });

    // ===== Ta≈ü Kontrolleri (Mahjong Kurallarƒ±) =====
    function isTileBlocked(tile) {
      // Ta≈ü √ºzerinde ba≈üka ta≈ü var mƒ± kontrol et
      const above = tiles.find(t => 
        !t.matched && 
        t.z === tile.z + 1 &&
        Math.abs(t.x - tile.x) <= 0.5 &&
        Math.abs(t.y - tile.y) <= 0.5
      );
      if (above) return true;

      // Yan taraflar a√ßƒ±k mƒ± kontrol et
      const leftBlocked = tiles.some(t => 
        !t.matched && 
        t.z === tile.z &&
        t.x === tile.x - 1 &&
        t.y === tile.y
      );
      const rightBlocked = tiles.some(t => 
        !t.matched && 
        t.z === tile.z &&
        t.x === tile.x + 1 &&
        t.y === tile.y
      );

      return leftBlocked && rightBlocked;
    }

    function updateTileStates() {
      tiles.forEach(tile => {
        if (!tile.matched) {
          const blocked = isTileBlocked(tile);
          tile.element.classList.toggle('blocked', blocked);
        }
      });
    }

    // ===== Oyun Kurulumu =====
    function setupGame() {
      // Ayarlarƒ± al
      const lang = langSelect.value;
      const level = levelSelect.value;
      const layout = layouts[level];
      totalPairs = layout.length / 2;

      // Kelimeleri se√ß
      const words = shuffle([...wordPool[lang]]).slice(0, totalPairs);
      const tileWords = [];
      words.forEach(word => {
        tileWords.push(word, word); // Her kelimeden 2 tane
      });
      shuffle(tileWords);

      // Tahtayƒ± temizle
      boardEl.innerHTML = '';
      tiles = [];
      selectedTile = null;
      score = 0;
      moves = 0;
      matches = 0;

      // Ta≈ülarƒ± olu≈ütur
      layout.forEach((pos, idx) => {
        const tile = {
          x: pos.x,
          y: pos.y,
          z: pos.z,
          word: tileWords[idx],
          matched: false,
          element: null
        };

        const div = document.createElement('div');
        div.className = 'tile';
        div.textContent = tile.word;
        
        // Pozisyonlama (3D efekti i√ßin)
        const left = pos.x * 70 - pos.z * 4;
        const top = pos.y * 90 - pos.z * 4;
        const zIndex = pos.z * 100 + pos.y * 10 + pos.x;
        
        div.style.left = left + 'px';
        div.style.top = top + 'px';
        div.style.zIndex = zIndex;

        div.addEventListener('click', () => onTileClick(tile));
        
        tile.element = div;
        tiles.push(tile);
        boardEl.appendChild(div);
      });

      // Tahta boyutunu ayarla
      const maxX = Math.max(...layout.map(p => p.x));
      const maxY = Math.max(...layout.map(p => p.y));
      const maxZ = Math.max(...layout.map(p => p.z));
      boardEl.style.width = (maxX * 70 + 80 + maxZ * 4) + 'px';
      boardEl.style.height = (maxY * 90 + 100 + maxZ * 4) + 'px';

      updateTileStates();
      updateUI();
    }

    // ===== Ta≈ü Tƒ±klama =====
    function onTileClick(tile) {
      if (!gameActive || tile.matched || isTileBlocked(tile)) return;

      if (selectedTile === tile) {
        // Aynƒ± ta≈üa tekrar tƒ±klandƒ±, se√ßimi kaldƒ±r
        tile.element.classList.remove('selected');
        selectedTile = null;
        return;
      }

      if (!selectedTile) {
        // ƒ∞lk ta≈ü se√ßimi
        selectedTile = tile;
        tile.element.classList.add('selected');
      } else {
        // ƒ∞kinci ta≈ü se√ßimi - e≈üle≈üme kontrol√º
        moves++;
        
        if (selectedTile.word === tile.word) {
          // E≈üle≈üme ba≈üarƒ±lƒ±!
          selectedTile.matched = true;
          tile.matched = true;
          selectedTile.element.classList.remove('selected');
          selectedTile.element.classList.add('matched');
          tile.element.classList.add('matched');
          
          matches++;
          score += 100;
          
          setTimeout(() => {
            selectedTile.element.style.opacity = '0';
            tile.element.style.opacity = '0';
            selectedTile = null;
            updateTileStates();
            updateUI();
            
            // Oyun bitti mi?
            if (matches === totalPairs) {
              endGame(true);
            }
          }, 500);
        } else {
          // E≈üle≈üme ba≈üarƒ±sƒ±z
          const wrongTile = tile;
          wrongTile.element.classList.add('selected');
          score = Math.max(0, score - 25);
          
          setTimeout(() => {
            selectedTile.element.classList.remove('selected');
            wrongTile.element.classList.remove('selected');
            selectedTile = null;
            updateUI();
          }, 600);
        }
      }
    }

    // ===== UI G√ºncelleme =====
    function updateUI() {
      scoreEl.textContent = score;
      matchesEl.textContent = `${matches}/${totalPairs}`;
      movesEl.textContent = moves;
    }

    // ===== Zamanlayƒ±cƒ± =====
    function startTimer() {
      const timeLimit = parseInt(timeSelect.value);
      if (timeLimit === 0) {
        timeLeftEl.textContent = '‚àû';
        return;
      }

      timeRemaining = timeLimit;
      timeLeftEl.textContent = formatTime(timeRemaining);

      clearInterval(timer);
      timer = setInterval(() => {
        if (!gameActive) return;
        
        timeRemaining--;
        timeLeftEl.textContent = formatTime(timeRemaining);
        
        if (timeRemaining <= 0) {
          endGame(false);
        }
      }, 1000);
    }

    // ===== Oyun Ba≈ülat/Bitir =====
    function startGame() {
      setupGame();
      gameActive = true;
      startBtn.disabled = true;
      resetBtn.disabled = false;
      hintBtn.disabled = false;
      statusEl.innerHTML = '<span class="info">üéÆ Oyun ba≈üladƒ±! ƒ∞yi ≈üanslar!</span>';
      startTimer();
    }

    function endGame(won) {
      gameActive = false;
      clearInterval(timer);
      startBtn.disabled = false;
      resetBtn.disabled = true;
      hintBtn.disabled = true;

      const playerName = localStorage.getItem(NAME_KEY) || 'Oyuncu';
      const lang = langSelect.value;
      const level = levelSelect.value;
      const timeLimit = parseInt(timeSelect.value);

      if (won) {
        statusEl.innerHTML = `<span class="success">üéâ Tebrikler! Oyunu kazandƒ±nƒ±z! Puan: ${score}</span>`;
        
        // Skoru kaydet
        saveScore({
          name: playerName,
          score: score,
          moves: moves,
          lang: lang,
          level: level,
          time: timeLimit === 0 ? 'Sƒ±nƒ±rsƒ±z' : formatTime(timeLimit - timeRemaining),
          date: new Date().toISOString()
        });
      } else {
        statusEl.innerHTML = `<span class="danger">‚è∞ S√ºre doldu! Puan: ${score}</span>`;
      }
    }

    // ===== ƒ∞pucu =====
    hintBtn.addEventListener('click', () => {
      if (!gameActive) return;

      const availableTiles = tiles.filter(t => !t.matched && !isTileBlocked(t));
      const pairs = [];

      for (let i = 0; i < availableTiles.length; i++) {
        for (let j = i + 1; j < availableTiles.length; j++) {
          if (availableTiles[i].word === availableTiles[j].word) {
            pairs.push([availableTiles[i], availableTiles[j]]);
          }
        }
      }

      if (pairs.length > 0) {
        const [tile1, tile2] = pairs[0];
        tile1.element.style.borderColor = '#f59e0b';
        tile2.element.style.borderColor = '#f59e0b';
        
        setTimeout(() => {
          tile1.element.style.borderColor = '';
          tile2.element.style.borderColor = '';
        }, 2000);
        
        score = Math.max(0, score - 50);
        updateUI();
        statusEl.innerHTML = '<span class="info">üí° ƒ∞pucu g√∂sterildi (-50 puan)</span>';
      } else {
        statusEl.innerHTML = '<span class="danger">‚ùå Uygun e≈üle≈üme bulunamadƒ±!</span>';
      }
    });

    // ===== Skor Y√∂netimi =====
    function saveScore(scoreData) {
      const scores = JSON.parse(localStorage.getItem(SCORES_KEY) || '[]');
      scores.push(scoreData);
      scores.sort((a, b) => b.score - a.score);
      localStorage.setItem(SCORES_KEY, JSON.stringify(scores.slice(0, 20)));
      renderScores();
    }

    function renderScores() {
      const scores = JSON.parse(localStorage.getItem(SCORES_KEY) || '[]');
      
      if (scores.length === 0) {
        scoreListEl.innerHTML = '<div style="text-align: center; color: #64748b; padding: 20px;">Hen√ºz skor yok</div>';
        return;
      }

      const levelNames = {easy: 'Kolay', medium: 'Orta', hard: 'Zor'};
      const langNames = {en: 'üá¨üáß', kr: 'üá∞üá∑'};

      scoreListEl.innerHTML = scores.map((s, i) => `
        <div class="score-item ${i === 0 ? 'top' : ''}">
          <div class="score-header">
            <span class="score-name">${i + 1}. ${s.name}</span>
            <span class="score-points">${s.score}</span>
          </div>
          <div class="score-details">
            <span>${langNames[s.lang]} ${levelNames[s.level]}</span>
            <span>‚è±Ô∏è ${s.time}</span>
            <span>üë£ ${s.moves} hamle</span>
          </div>
        </div>
      `).join('');
    }

    clearScoresBtn.addEventListener('click', () => {
      if (confirm('T√ºm skorlarƒ± silmek istediƒüinizden emin misiniz?')) {
        localStorage.removeItem(SCORES_KEY);
        renderScores();
      }
    });

    // ===== Buton Event Listeners =====
    startBtn.addEventListener('click', startGame);
    resetBtn.addEventListener('click', startGame);

    // ===== ƒ∞lk Y√ºkleme =====
    getPlayerName();
    renderScores();
    setupGame();
  </script>
</body>
</html>
