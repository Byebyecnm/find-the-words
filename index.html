<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Kelimeli Mahjong - ZamanlÄ±, PuanlÄ±, Ä°simli Skor Tablosu</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; background:#0f172a; color:#e5e7eb; margin:0; padding:24px; }
    h1 { margin:0 0 12px; }
    .layout { max-width: 1200px; margin: 0 auto; display:grid; grid-template-columns: 320px 1fr; gap:16px; }
    @media (max-width: 900px){ .layout{ grid-template-columns: 1fr; } }

    .panel { background:#020617; border:1px solid #1f2933; border-radius:16px; padding:12px; }
    .panel h3{ margin:4px 0 8px; }
    .best-table{ width:100%; border-collapse:separate; border-spacing:0 8px; font-size:13px; }
    .best-table th{ text-align:left; color:#94a3b8; font-weight:600; padding:0 6px 4px; }
    .best-row{ background:#0b1220; border:1px solid #1f2933; border-radius:12px; }
    .best-row td{ padding:8px 10px; }
    .best-row.first{ outline:2px solid #22c55e; box-shadow:0 0 0 2px rgba(34,197,94,.2) inset; }

    .toolbar { display:flex; gap:12px; flex-wrap:wrap; align-items:center; margin-bottom:16px; }
    select, button, input { background:#111827; color:#e5e7eb; border:1px solid #334155; border-radius:10px; padding:10px 14px; }
    button { cursor:pointer; }
    button.primary { background:#2563eb; border-color:#2563eb; }
    button.warn { background:#7c2d12; border-color:#7c2d12; }
    button:disabled { opacity:0.6; cursor:not-allowed; }
    .stats { margin-left:auto; display:flex; gap:16px; flex-wrap:wrap; }
    .board { display:grid; gap:10px; }
    .tile { background:#020617; border:1px solid #1f2933; border-radius:14px; padding:18px; min-height:78px; display:flex; align-items:center; justify-content:center; text-align:center; font-weight:700; font-size:22px; user-select:none; transition: transform .1s ease, background .2s ease, border .2s ease; }
    .tile:hover { transform: translateY(-1px); }
    .tile.hidden { background:#020617; color:transparent; }
    .tile.revealed { background:#0b1220; border-color:#3b82f6; }
    .tile.matched { background:#052e16; border-color:#22c55e; color:#86efac; }
    .footer { margin-top:16px; color:#94a3b8; }
    .success { color:#22c55e; }
    .danger { color:#f87171; }
    .grid { grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); }

    .namebar{ display:flex; gap:8px; align-items:center; margin-bottom:8px; }
    .badge{ background:#0b1220; border:1px solid #1f2933; border-radius:999px; padding:6px 10px; font-size:12px; }
  </style>
</head>
<body>
  <div class="layout">
    <!-- Sol: En Ä°yiler -->
    <aside class="panel">
      <h3>ğŸ† En Ä°yiler</h3>
      <p style="color:#94a3b8; font-size:13px; margin:0 0 8px;">Ä°sim â€¢ Dil â€¢ Seviye â€¢ SÃ¼re â€¢ Puan</p>
      <table class="best-table">
        <thead>
          <tr>
            <th>#</th><th>Ä°sim</th><th>Dil</th><th>Seviye</th><th>SÃ¼re</th><th>Puan</th>
          </tr>
        </thead>
        <tbody id="bestBody"></tbody>
      </table>
      <button id="clearBest" class="warn" style="margin-top:8px; width:100%">SkorlarÄ± Temizle</button>
    </aside>

    <!-- SaÄŸ: Oyun -->
    <main class="app">
      <h1>ğŸ€„ Kelimeli Mahjong â€” ZamanlÄ± & PuanlÄ±</h1>
      <div class="namebar">
        <span class="badge">Oyuncu:</span>
        <strong id="playerNameLabel">â€”</strong>
        <button id="changeNameBtn">Ä°smi DeÄŸiÅŸtir</button>
      </div>
      <p>En basit: <b>16 Ã§ift</b>, Orta: <b>32 Ã§ift</b>, Ä°leri: <b>64 Ã§ift</b>. DoÄŸru = +100, YanlÄ±ÅŸ = -25.</p>

      <div class="toolbar">
        <label>
          Dil:
          <select id="langSelect">
            <option value="en">Ä°ngilizce</option>
            <option value="kr">Korece</option>
          </select>
        </label>
        <label>
          Seviye:
          <select id="levelSelect">
            <option value="0">En Basit (16 Ã‡ift)</option>
            <option value="1">Orta (32 Ã‡ift)</option>
            <option value="2">Ä°leri (64 Ã‡ift)</option>
          </select>
        </label>
        <label>
          SÃ¼re:
          <select id="timeSelect">
            <option value="120">120 sn</option>
            <option value="180">180 sn</option>
            <option value="300">300 sn</option>
          </select>
        </label>
        <button class="primary" id="startBtn">BaÅŸlat</button>
        <button class="warn" id="resetBtn">Yeniden BaÅŸlat</button>
        <div class="stats">
          <div>â±ï¸ <strong id="timeLeft">0</strong>s</div>
          <div>â­ <strong id="score">0</strong></div>
          <div>ğŸ¯ <strong id="matches">0</strong></div>
          <div>ğŸ‘£ <strong id="moves">0</strong></div>
        </div>
      </div>

      <div id="board" class="board grid"></div>
      <div class="footer" id="status"></div>
    </main>
  </div>

  <script>
    // ===== Kelime HavuzlarÄ± =====
    const pool = {
      en: [
        ['apple','elma'], ['book','kitap'], ['water','su'], ['sun','gÃ¼neÅŸ'], ['dog','kÃ¶pek'], ['house','ev'], ['travel','seyahat'], ['friend','arkadaÅŸ'], ['music','mÃ¼zik'], ['money','para'], ['city','ÅŸehir'], ['food','yemek'], ['work','iÅŸ'], ['school','okul'], ['decision','karar'], ['improve','geliÅŸtirmek'], ['environment','Ã§evre'], ['knowledge','bilgi'], ['opportunity','fÄ±rsat'], ['challenge','zorluk'], ['culture','kÃ¼ltÃ¼r'], ['language','dil'], ['future','gelecek'], ['success','baÅŸarÄ±'], ['time','zaman'], ['day','gÃ¼n'], ['night','gece'], ['family','aile'], ['love','sevgi'], ['game','oyun'], ['learn','Ã¶ÄŸrenmek'], ['write','yazmak'], ['read','okumak']
      ],
      kr: [
        ['ì‚¬ê³¼','elma'], ['ì±…','kitap'], ['ë¬¼','su'], ['í•´','gÃ¼neÅŸ'], ['ê°œ','kÃ¶pek'], ['ì§‘','ev'], ['ì—¬í–‰','seyahat'], ['ì¹œêµ¬','arkadaÅŸ'], ['ìŒì•…','mÃ¼zik'], ['ëˆ','para'], ['ë„ì‹œ','ÅŸehir'], ['ìŒì‹','yemek'], ['ì¼','iÅŸ'], ['í•™êµ','okul'], ['ê²°ì •','karar'], ['ê°œì„ í•˜ë‹¤','geliÅŸtirmek'], ['í™˜ê²½','Ã§evre'], ['ì§€ì‹','bilgi'], ['ê¸°íšŒ','fÄ±rsat'], ['ë„ì „','zorluk'], ['ë¬¸í™”','kÃ¼ltÃ¼r'], ['ì–¸ì–´','dil'], ['ë¯¸ë˜','gelecek'], ['ì„±ê³µ','baÅŸarÄ±'], ['ì‹œê°„','zaman'], ['ë‚®','gÃ¼n'], ['ë°¤','gece'], ['ê°€ì¡±','aile'], ['ì‚¬ë‘','sevgi'], ['ê²Œì„','oyun'], ['ë°°ìš°ë‹¤','Ã¶ÄŸrenmek'], ['ì“°ë‹¤','yazmak'], ['ì½ë‹¤','okumak']
      ]
    };
    const levelPairs = [16, 32, 64];

    // ===== DOM =====
    const langSelect = document.getElementById('langSelect');
    const levelSelect = document.getElementById('levelSelect');
    const timeSelect = document.getElementById('timeSelect');
    const boardEl = document.getElementById('board');
    const startBtn = document.getElementById('startBtn');
    const resetBtn = document.getElementById('resetBtn');
    const movesEl = document.getElementById('moves');
    const matchesEl = document.getElementById('matches');
    const scoreEl = document.getElementById('score');
    const timeLeftEl = document.getElementById('timeLeft');
    const statusEl = document.getElementById('status');
    const bestBody = document.getElementById('bestBody');
    const clearBestBtn = document.getElementById('clearBest');
    const playerNameLabel = document.getElementById('playerNameLabel');
    const changeNameBtn = document.getElementById('changeNameBtn');

    // ===== Oyun Durumu =====
    let first = null, second = null, lock = false;
    let moves = 0, matches = 0, totalPairs = 0, score = 0;
    let timer = null, timeLeft = 0, gameActive = false;

    // ===== YardÄ±mcÄ±lar =====
    function shuffle(array) { for (let i = array.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); [array[i], array[j]] = [array[j], array[i]]; } return array; }
    function buildPairs(lang, needed) { const base = pool[lang]; const pairs = []; let i = 0; while (pairs.length < needed) { const p = base[i % base.length]; pairs.push([p[0], p[1]]); i++; } return pairs; }

    // ===== Ä°sim =====
    const NAME_KEY = 'mahjong_player_name_v1';
    function askName(force=false){ let name = localStorage.getItem(NAME_KEY); if(!name || force){ name = prompt('Oyuncu adÄ±nÄ± gir:', name || '') || 'Misafir'; localStorage.setItem(NAME_KEY, name); } playerNameLabel.textContent = name; return name; }
    changeNameBtn.addEventListener('click', ()=> askName(true));

    // ===== Zaman =====
    function startTimer(){ clearInterval(timer); timer = setInterval(()=>{ if(!gameActive) return; timeLeft--; timeLeftEl.textContent = timeLeft; if(timeLeft<=0){ endGame(false); } }, 1000); }

    // ===== Oyun Kurulumu =====
    function setupBoard(){ const lang = langSelect.value; const lvl = Number(levelSelect.value); const neededPairs = levelPairs[lvl]; const pairs = buildPairs(lang, neededPairs);
      const tiles = []; pairs.forEach(([a,b], idx)=>{ tiles.push({id:idx, text:a}); tiles.push({id:idx, text:b}); });
      totalPairs = pairs.length; moves=0; matches=0; score=0; movesEl.textContent=moves; matchesEl.textContent=matches; scoreEl.textContent=score; statusEl.textContent='';
      boardEl.innerHTML=''; first=null; second=null; lock=false;
      const shuffled = shuffle(tiles); boardEl.className='board grid';
      shuffled.forEach(tile=>{ const div=document.createElement('div'); div.className='tile hidden'; div.dataset.id=tile.id; div.dataset.text=tile.text; div.textContent=tile.text; div.addEventListener('click', ()=>onTileClick(div)); boardEl.appendChild(div); }); }

    function startGame(){ setupBoard(); timeLeft = Number(timeSelect.value); timeLeftEl.textContent = timeLeft; gameActive=true; lock=false; startTimer(); }

    function onTileClick(tile){ if(!gameActive || lock) return; if(tile.classList.contains('matched') || tile===first) return; tile.classList.remove('hidden'); tile.classList.add('revealed'); if(!first){ first=tile; return; }
      second=tile; lock=true; moves++; movesEl.textContent=moves; const isMatch = first.dataset.id===second.dataset.id && first.dataset.text!==second.dataset.text;
      if(isMatch){ setTimeout(()=>{ first.classList.remove('revealed'); second.classList.remove('revealed'); first.classList.add('matched'); second.classList.add('matched'); matches++; matchesEl.textContent=matches; score+=100; scoreEl.textContent=score; resetPick(); if(matches===totalPairs){ endGame(true); } }, 200); }
      else{ setTimeout(()=>{ first.classList.add('hidden'); second.classList.add('hidden'); first.classList.remove('revealed'); second.classList.remove('revealed'); score=Math.max(0, score-25); scoreEl.textContent=score; resetPick(); }, 450); }
    }
    function resetPick(){ first=null; second=null; lock=false; }

    // ===== En Ä°yiler (LocalStorage) =====
    const BEST_KEY = 'mahjong_best_v2';
    function loadBest(){ try{ return JSON.parse(localStorage.getItem(BEST_KEY) || '[]'); } catch{ return []; } }
    function saveBest(entry){ const list = loadBest(); list.push(entry); list.sort((a,b)=> b.score - a.score); const trimmed = list.slice(0, 10); localStorage.setItem(BEST_KEY, JSON.stringify(trimmed)); }
    function renderBest(){ const list = loadBest(); bestBody.innerHTML=''; if(list.length===0){ const tr=document.createElement('tr'); tr.className='best-row'; tr.innerHTML='<td colspan="6">HenÃ¼z kayÄ±t yok</td>'; bestBody.appendChild(tr); return; }
      list.forEach((e,i)=>{ const tr=document.createElement('tr'); tr.className='best-row' + (i===0?' first':''); const lvlText = ['16Ã‡','32Ã‡','64Ã‡'][e.lvl] || ''; const langText = e.lang==='kr'?'KR':'EN'; tr.innerHTML = `<td>${i+1}</td><td>${e.name}</td><td>${langText}</td><td>${lvlText}</td><td>${e.duration}s</td><td><strong>${e.score}</strong></td>`; bestBody.appendChild(tr); }); }

    function endGame(won){ gameActive=false; clearInterval(timer); lock=true; const name = localStorage.getItem(NAME_KEY) || 'Misafir'; const lang=langSelect.value; const lvl=Number(levelSelect.value); const duration=Number(timeSelect.value);
      statusEl.innerHTML = won ? `<span class="success">KazandÄ±n! Skor: ${score}</span>` : `<span class="danger">SÃ¼re Doldu â° Skor: ${score}</span>`;
      saveBest({ date:new Date().toISOString(), name, lang, lvl, duration, score }); renderBest(); }

    clearBestBtn.addEventListener('click', ()=>{ localStorage.removeItem(BEST_KEY); renderBest(); });
    startBtn.addEventListener('click', startGame); resetBtn.addEventListener('click', startGame);

    // Ä°lk aÃ§Ä±lÄ±ÅŸ
    askName(false); renderBest(); timeLeftEl.textContent = timeSelect.value;
  </script>
</body>
</html>